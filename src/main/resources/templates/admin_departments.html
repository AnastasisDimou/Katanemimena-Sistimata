<!DOCTYPE html>
<html
   xmlns:th="https://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{base}"
>
   <head>
      <title>Διαχείριση Τμημάτων</title>
   </head>

   <body>
      <main layout:fragment="main" class="content-main container-sm">
         <h1 class="text-xl">Διαχείριση Τμημάτων</h1>
         <p class="muted" style="margin-bottom: 16px">Προσθέστε ή αφαιρέστε τμήματα.</p>

         <div th:if="${successMessage != null}" class="alert alert-success" th:text="${successMessage}"></div>
         <div th:if="${errorMessage != null}" class="alert alert-danger" th:text="${errorMessage}"></div>

         <div class="card-box">
            <h2 class="text-lg" style="margin-top: 0">Νέο Τμήμα</h2>
            <form th:action="@{/admin/departments}" method="post" th:object="${departmentForm}">
               <div class="form-group">
                  <label class="form-label" for="code">Κωδικός</label>
                  <input class="form-control" id="code" th:field="*{code}" placeholder="π.χ. KEP" />
                  <div class="error-message" th:if="${#fields.hasErrors('code')}" th:errors="*{code}"></div>
               </div>
               <div class="form-group">
                  <label class="form-label" for="name">Όνομα</label>
                  <input class="form-control" id="name" th:field="*{name}" placeholder="π.χ. ΚΕΠ Δήμου" />
                  <div class="error-message" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
               </div>
               <div class="form-group">
                  <label class="form-label" for="description">Περιγραφή</label>
                  <textarea class="form-textarea" id="description" rows="3" th:field="*{description}"
                     placeholder="Σύντομη περιγραφή τμήματος"></textarea>
                  <div class="error-message" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></div>
               </div>
               <button type="submit" class="btn btn-primary text-md">
                  <i class="fas fa-plus-circle"></i> Προσθήκη Τμήματος
               </button>
            </form>
         </div>

         <div class="card-box" style="margin-top: 20px">
            <div class="table-clean__header">
               <span>Υπάρχοντα Τμήματα</span>
            </div>
            <div class="table-clean">
               <table>
                  <thead>
                     <tr>
                        <th>Κωδικός</th>
                        <th>Όνομα</th>
                        <th>Περιγραφή</th>
                        <th style="width: 110px">Ενέργεια</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr th:each="d : ${departments}">
                        <td th:text="${d.code}">CODE</td>
                        <td th:text="${d.name}">Όνομα</td>
                        <td th:text="${d.description} ?: '-'">Περιγραφή</td>
                        <td>
                           <form th:action="@{|/admin/departments/${d.id}/delete|}" method="post"
                              onsubmit="return confirm('Διαγραφή τμήματος;');">
                              <button type="submit" class="btn btn-danger btn-sm">
                                 <i class="fas fa-trash"></i> Διαγραφή
                              </button>
                           </form>
                        </td>
                     </tr>
                     <tr th:if="${departments == null || departments.isEmpty()}">
                        <td colspan="4" style="text-align: center; color: #777">Δεν υπάρχουν τμήματα.</td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </div>
      </main>
   </body>
</html>
