<!DOCTYPE html>
<html
   xmlns:th="https://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{base}"
>
   <head>
      <title>Αιτήματα</title>
   </head>

   <body>
      <main layout:fragment="main">
         <section class="hero">
            <div class="container text-center">
               <div class="hero-content">
                  <h1 class="hero-text text-xxl"
                     th:text="${me != null and me.type().name() == 'ADMIN'} ? 'Διαχείριση Αιτημάτων' : (${me != null and me.type().name() == 'EMPLOYEE'} ? 'Αιτήματα' : 'Τα Αιτήματά μου')">
                     Τα Αιτήματά μου
                  </h1>
                  <p class="text-xl my-4 font-semibold">
                     Παρακολουθήστε την πορεία των αιτημάτων και ενημερωθείτε για την κατάσταση τους.
                  </p>
                  <div class="hero-buttons">
                     <a th:href="@{/tickets/new}" class="btn btn-primary" sec:authorize="hasRole('CITIZEN')">
                        <i class="fas fa-plus-circle"></i> Υποβολή νέου Αιτήματος
                     </a>
                     <a th:href="@{/admin/request-types}" class="btn btn-primary" sec:authorize="hasRole('ADMIN')">
                        <i class="fas fa-tasks"></i> Διαχείριση Αιτημάτων
                     </a>
                  </div>
               </div>
            </div>
         </section>

         <section class="container" style="margin: 50px auto">
            <div class="preview-card">
               <div class="preview-card__header">
                  <div>
                     <h2 id="ticket-list" class="text-lg">Λίστα Αιτημάτων</h2>
                     <p class="muted">Πιο πρόσφατα αιτήματα</p>
                  </div>
               </div>
               <ul class="preview-list">
                  <li th:each="r : ${requests}">
                     <a class="preview-item preview-item--link" th:href="@{|/tickets/${r.id()}|}">
                        <div>
                           <div class="preview-item__title" th:text="${r.subject()}">Θέμα</div>
                           <div class="preview-item__meta">
                              <span th:text="${r.protocolNumber()}">REQ-000</span>
                              <span class="dot">•</span>
                              <span th:text="${r.department().name()}">Τμήμα</span>
                              <span class="dot">•</span>
                              <span th:text="${#temporals.format(r.submittedAt(), 'dd-MM-yyyy HH:mm')}">Ημερομηνία</span>
                           </div>
                        </div>
                        <span class="status-pill" th:text="${r.status().name()}">STATUS</span>
                     </a>
                  </li>
                  <li th:if="${requests == null || requests.isEmpty()}" class="preview-empty">
                     Δεν βρέθηκαν καταχωρημένα αιτήματα.
                  </li>
               </ul>
            </div>
         </section>
      </main>
   </body>
</html>
